# PyAssistant - Pythonç¼–ç¨‹æ™ºèƒ½åŠ©æ‰‹

## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®ç®€ä»‹
PyAssistant æ˜¯ä¸€ä¸ªåŸºäº Web çš„ Python ç¼–ç¨‹æ™ºèƒ½åŠ©æ‰‹ï¼Œé›†æˆäº† AI å¯¹è¯ã€ä»£ç å·¥å…·ã€è¯­éŸ³è¯†åˆ«å’Œç½‘é¡µçˆ¬è™«ç­‰åŠŸèƒ½ï¼Œä¸º Python å¼€å‘è€…æä¾›å…¨æ–¹ä½çš„ç¼–ç¨‹è¾…åŠ©ã€‚

### æ ¸å¿ƒä»·å€¼
- ğŸ¤– æ™ºèƒ½ç¼–ç¨‹åŠ©æ‰‹ - AI é©±åŠ¨çš„ä»£ç åˆ†æå’Œå»ºè®®
- ğŸ› ï¸ ä¸€ä½“åŒ–å·¥å…· - ä»£ç æ‰§è¡Œã€è¯­æ³•æ£€æŸ¥ã€æ–‡æ¡£æŸ¥è¯¢
- ğŸ™ï¸ å¤šæ¨¡æ€äº¤äº’ - æ”¯æŒæ–‡æœ¬å’Œè¯­éŸ³è¾“å…¥
- ğŸ“± è·¨å¹³å°è®¿é—® - å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå¤šè®¾å¤‡
- ğŸ’¾ æ•°æ®æŒä¹…åŒ– - ç”¨æˆ·ç³»ç»Ÿå’Œå¯¹è¯å†å²

### é€‚ç”¨åœºæ™¯
- Python å­¦ä¹ å’Œæ•™å­¦
- ä»£ç è°ƒè¯•å’Œä¼˜åŒ–
- æŠ€æœ¯æ–‡æ¡£æŸ¥è¯¢
- ç½‘é¡µæ•°æ®é‡‡é›†
- ç¼–ç¨‹é—®é¢˜è§£ç­”

## é¡¹ç›®ç»“æ„

```
PyAssistant/
â”œâ”€â”€ app.py                 # Flaskåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ python_agent.py        # AIæ™ºèƒ½ä»£ç†
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
â”œâ”€â”€ README.md             # é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ Pyassistant_help.html # è¯¦ç»†å¸®åŠ©æ–‡æ¡£
â”œâ”€â”€ Pyassistant_source_code.html # æºä»£ç æŸ¥çœ‹å™¨
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html        # ä¸»é¡µé¢HTMLæ¨¡æ¿
â””â”€â”€ static/
    â”œâ”€â”€ style.css         # å‰ç«¯æ ·å¼æ–‡ä»¶
    â”œâ”€â”€ script.js         # å‰ç«¯é€»è¾‘è„šæœ¬
    â”œâ”€â”€ pyassistant.png   # åº”ç”¨å›¾æ ‡
    â””â”€â”€ temp/             # ä¸´æ—¶æ–‡ä»¶ç›®å½•
```

## åŠŸèƒ½ç‰¹æ€§

### å¯¹è¯åŠ©æ‰‹
- **AI å¯¹è¯**: æ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼Œæ”¯æŒä¸Šä¸‹æ–‡ç†è§£
- **å†å²ç®¡ç†**: å¯¹è¯è®°å½•ä¿å­˜ï¼Œæ”¯æŒæ ‡é¢˜è‡ªåŠ¨ç”Ÿæˆ
- **æ¶ˆæ¯æ ¼å¼**: å¯Œæ–‡æœ¬æ˜¾ç¤ºï¼Œæ”¯æŒä»£ç é«˜äº®ã€è¡¨æ ¼
- **å®æ—¶äº¤äº’**: æµå¼è¾“å‡ºï¼Œæ‰“å­—æœºæ•ˆæœ

### ä»£ç å·¥å…·é›†
- **è¯­æ³•æ£€æŸ¥**: æ£€æŸ¥ Python ä»£ç è¯­æ³•é”™è¯¯ï¼Œæä¾›è¯¦ç»†é”™è¯¯æŠ¥å‘Šå’Œæ”¹è¿›å»ºè®®
- **ä»£ç æ‰§è¡Œ**: å®‰å…¨æ‰§è¡Œ Python ä»£ç ç‰‡æ®µï¼Œå®æ—¶è¿”å›æ‰§è¡Œç»“æœæˆ–é”™è¯¯ä¿¡æ¯
- **ä»£ç åˆ†æ**: åˆ†æä»£ç è´¨é‡ï¼Œæä¾›ç»“æ„æ¦‚è§ˆå’Œä¼˜åŒ–å»ºè®®
- **æ–‡æ¡£æŸ¥è¯¢**: å¿«é€ŸæŸ¥è¯¢ Python å®˜æ–¹æ–‡æ¡£ï¼Œè·å–è¯¦ç»†å‡½æ•°å’Œæ¨¡å—è¯´æ˜

### Python çˆ¬è™«
- **ç½‘é¡µæŠ“å–**: è·å–ç½‘é¡µå†…å®¹ï¼ˆä½¿ç”¨ Firecrawl APIï¼‰
- **æ ¼å¼è½¬æ¢**: è‡ªåŠ¨è½¬æ¢ä¸º Markdown æ ¼å¼
- **ç»“æœé¢„è§ˆ**: å†…å®¹é¢„è§ˆï¼Œä»£ç é«˜äº®
- **å†…å®¹å¯¼å‡º**: æ”¯æŒå¤åˆ¶/å‘é€åˆ°å¯¹è¯ï¼Œå¤šç§æ ¼å¼

### è¯­éŸ³è¯†åˆ«
- **è¯­éŸ³è¾“å…¥**: å½•éŸ³è½¬æ–‡å­—ï¼ˆä½¿ç”¨è®¯é£è¯­éŸ³è¯†åˆ«ï¼‰
- **å®æ—¶åé¦ˆ**: å½•éŸ³çŠ¶æ€æ˜¾ç¤ºï¼Œå¯è§†åŒ–æŒ‡ç¤º
- **æ ¼å¼æ”¯æŒ**: æ”¯æŒ WebM, WAV, PCM æ ¼å¼
- **è‡ªåŠ¨è½¬æ¢**: éŸ³é¢‘æ ¼å¼å¤„ç†ï¼ˆä½¿ç”¨ PyDub/FFmpegï¼‰

### ç”¨æˆ·ç³»ç»Ÿ
- **ç”¨æˆ·æ³¨å†Œ**: æ–°ç”¨æˆ·æ³¨å†Œï¼Œç”¨æˆ·åå¯†ç éªŒè¯
- **ç”¨æˆ·ç™»å½•**: èº«ä»½éªŒè¯ï¼ŒSession ç®¡ç†
- **å¯¹è¯éš”ç¦»**: ç”¨æˆ·æ•°æ®éš”ç¦»ï¼Œå¤šç”¨æˆ·æ”¯æŒ
- **å®‰å…¨é€€å‡º**: ä¼šè¯æ¸…ç†ï¼Œè‡ªåŠ¨è·³è½¬

### UI/UX ç‰¹æ€§
- **ä¸»é¢˜åˆ‡æ¢**: æ·±è‰²/æµ…è‰²ä¸»é¢˜ï¼Œå®æ—¶åˆ‡æ¢ï¼Œä¿æŠ¤è§†åŠ›
- **å“åº”å¼è®¾è®¡**: ç§»åŠ¨ç«¯é€‚é…ï¼Œå¤šå±å¹•æ”¯æŒï¼Œä¼˜åŒ–è§¦æ§ä½“éªŒ
- **ä»£ç é«˜äº®**: è¯­æ³•é«˜äº®æ˜¾ç¤ºï¼ˆä½¿ç”¨ Highlight.jsï¼‰ï¼Œæå‡ä»£ç å¯è¯»æ€§
- **åŠ¨ç”»æ•ˆæœ**: å¹³æ»‘è¿‡æ¸¡ï¼ŒCSS åŠ¨ç”»ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

## æŠ€æœ¯æ¶æ„

### å‰ç«¯æ¶æ„
```
Frontend (Browser)
â”œâ”€â”€ HTML5
â”‚   â”œâ”€â”€ è¯­ä¹‰åŒ–ç»“æ„
â”‚   â”œâ”€â”€ æ¨¡æ€å¯¹è¯æ¡†
â”‚   â””â”€â”€ è¡¨å•éªŒè¯
â”œâ”€â”€ CSS3
â”‚   â”œâ”€â”€ CSSå˜é‡ï¼ˆä¸»é¢˜ï¼‰
â”‚   â”œâ”€â”€ Flexbox/Gridå¸ƒå±€
â”‚   â”œâ”€â”€ åª’ä½“æŸ¥è¯¢ï¼ˆå“åº”å¼ï¼‰
â”‚   â””â”€â”€ åŠ¨ç”»è¿‡æ¸¡
â””â”€â”€ JavaScript
    â”œâ”€â”€ åŸç”ŸJS + Fetch API
    â”œâ”€â”€ äº‹ä»¶ç®¡ç†
    â”œâ”€â”€ çŠ¶æ€ç®¡ç†
    â””â”€â”€ è¯­éŸ³å½•åˆ¶
```

### åç«¯æ¶æ„
```
Backend (Flask)
â”œâ”€â”€ Webæ¡†æ¶
â”‚   â”œâ”€â”€ Flaskæ ¸å¿ƒ
â”‚   â”œâ”€â”€ è·¯ç”±ç®¡ç†
â”‚   â”œâ”€â”€ ä¼šè¯ç®¡ç†
â”‚   â””â”€â”€ æ¨¡æ¿æ¸²æŸ“
â”œâ”€â”€ æ•°æ®å±‚
â”‚   â”œâ”€â”€ MySQLæ•°æ®åº“
â”‚   â”œâ”€â”€ PyMySQLé©±åŠ¨
â”‚   â””â”€â”€ è¿æ¥æ± ç®¡ç†
â”œâ”€â”€ AIæœåŠ¡å±‚
â”‚   â”œâ”€â”€ LangChainé›†æˆ
â”‚   â”œâ”€â”€ DeepSeek/OpenAI
â”‚   â””â”€â”€ å·¥å…·è°ƒç”¨ç³»ç»Ÿ
â””â”€â”€ å·¥å…·æœåŠ¡
    â”œâ”€â”€ è¯­éŸ³è¯†åˆ«
    â”œâ”€â”€ ä»£ç æ‰§è¡Œ
    â”œâ”€â”€ ç½‘é¡µçˆ¬è™«
    â””â”€â”€ æ–‡ä»¶å¤„ç†
```

### ç³»ç»Ÿç»„ä»¶å›¾
```
ç”¨æˆ·ç•Œé¢ â†’ Flaskè·¯ç”± â†’ ä¸šåŠ¡é€»è¾‘ â†’ æ•°æ®å­˜å‚¨
    â†“          â†“           â†“         â†“
å‰ç«¯äº¤äº’   URLè·¯ç”±    AIä»£ç†å·¥å…·   MySQLæ•°æ®åº“
    â†“          â†“           â†“         â†“
è¯­éŸ³è¾“å…¥  ä¼šè¯ç®¡ç†   ä»£ç æ‰§è¡Œå™¨   ç”¨æˆ·è¡¨
    â†“          â†“           â†“         â†“
ä¸»é¢˜åˆ‡æ¢  è®¤è¯ä¸­é—´ä»¶  è¯­æ³•æ£€æŸ¥å™¨   å¯¹è¯è¡¨
    â†“          â†“           â†“         â†“
å®æ—¶é€šä¿¡  é”™è¯¯å¤„ç†   æ–‡æ¡£æŸ¥è¯¢å™¨   æ¶ˆæ¯è¡¨
```

## å®‰è£…éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚

**ç³»ç»Ÿè¦æ±‚:**
- æ“ä½œç³»ç»Ÿ: Windows 10+/macOS 10.14+/Linux Ubuntu 18.04+
- Python: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- å†…å­˜: æœ€ä½ 2GBï¼Œæ¨è 4GB+
- ç£ç›˜ç©ºé—´: è‡³å°‘ 500MB å¯ç”¨ç©ºé—´

**Python ä¾èµ–:**
```bash
# æ ¸å¿ƒæ¡†æ¶
Flask==2.3.3
langchain==0.0.346
langchain-openai==0.0.2

# æ•°æ®åº“
pymysql==1.1.0

# è¯­éŸ³å¤„ç†
websocket-client==1.6.3
pydub==0.25.1

# æ–‡æ¡£å¤„ç†
PyPDF2==3.0.1

# ç¯å¢ƒç®¡ç†
python-dotenv==1.0.0

# å…¶ä»–å·¥å…·
requests==2.31.0
```

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd PyAssistant
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **æ•°æ®åº“è®¾ç½®**
```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE pyassistant CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºç”¨æˆ·ï¼ˆå¯é€‰ï¼‰
CREATE USER 'pyassistant'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON pyassistant.* TO 'pyassistant'@'localhost';
FLUSH PRIVILEGES;
```

5. **ç¯å¢ƒé…ç½®**
åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=pyassistant
DB_PASSWORD=your_password
DB_NAME=pyassistant

# AI API é…ç½®
DEEPSEEK_API_KEY=your_deepseek_key
OPENAI_API_KEY=your_openai_key

# è¯­éŸ³è¯†åˆ«é…ç½®
XF_APP_ID=your_xf_app_id
XF_API_KEY=your_xf_api_key
XF_API_SECRET=your_xf_api_secret

# çˆ¬è™«é…ç½®
FIRECRAWL_API_KEY=your_firecrawl_key
```

6. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
python app.py
# é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨
```

7. **å¯åŠ¨åº”ç”¨**
```bash
python app.py
```
è®¿é—®: http://localhost:5007/pyassistant

## é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®
```python
DB_CONFIG = {
    'host': 'localhost',      # æ•°æ®åº“ä¸»æœº
    'user': 'pyassistant',    # æ•°æ®åº“ç”¨æˆ·
    'password': 'password',   # æ•°æ®åº“å¯†ç 
    'database': 'pyassistant', # æ•°æ®åº“å
    'charset': 'utf8mb4',     # å­—ç¬¦ç¼–ç 
    'cursorclass': pymysql.cursors.DictCursor
}
```

### AI æ¨¡å‹é…ç½®
```python
# DeepSeek é…ç½®
self.llm = ChatOpenAI(
    model="deepseek-chat",
    base_url="https://api.deepseek.com/v1",
    api_key=os.getenv("DEEPSEEK_API_KEY"),
    temperature=0.1
)

# OpenAI å¤‡ç”¨é…ç½®
self.llm = ChatOpenAI(
    model="gpt-3.5-turbo",
    api_key=os.getenv("OPENAI_API_KEY"),
    temperature=0.1
)
```

### è¯­éŸ³è¯†åˆ«é…ç½®
```python
class XunfeiVoiceRecognition:
    def __init__(self):
        self.app_id = os.getenv('XF_APP_ID')
        self.api_key = os.getenv('XF_API_KEY') 
        self.api_secret = os.getenv('XF_API_SECRET')
        self.ws_url = "wss://iat-api.xfyun.cn/v2/iat"
```

### å®‰å…¨é…ç½®
```python
app = Flask(__name__)
app.secret_key = 'your-secret-key-here'  # ç”Ÿäº§ç¯å¢ƒè¯·æ›´æ”¹

# ä»£ç æ‰§è¡Œå®‰å…¨é™åˆ¶
dangerous_patterns = [
    r'__import__\s*\(', r'eval\s*\(', r'exec\s*\(',
    r'open\s*\(', r'os\.', r'subprocess\.'
]
```

## ä½¿ç”¨æŒ‡å—

### é¦–æ¬¡ä½¿ç”¨

1. **ç”¨æˆ·æ³¨å†Œ**
   - è®¿é—®åº”ç”¨é¦–é¡µ
   - ç‚¹å‡»"ç™»å½•"æŒ‰é’®
   - åˆ‡æ¢åˆ°"æ³¨å†Œ"æ ‡ç­¾
   - è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ˆæœ€å°‘6ä½ï¼‰
   - å®Œæˆæ³¨å†Œå¹¶è‡ªåŠ¨ç™»å½•

2. **å¼€å§‹å¯¹è¯**
   - åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ Python ç›¸å…³é—®é¢˜
   - ç‚¹å‡»å‘é€æˆ–æŒ‰ Ctrl+Enter
   - æŸ¥çœ‹ AI å›å¤ï¼Œæ”¯æŒä»£ç é«˜äº®
   - ä½¿ç”¨å¤åˆ¶æŒ‰é’®ä¿å­˜ç­”æ¡ˆ

### æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨

**ä»£ç è¯­æ³•æ£€æŸ¥ç¤ºä¾‹ï¼š**
```python
# è¾“å…¥ç¤ºä¾‹ï¼š
def calculate_sum(a, b)
    return a + b

# è¾“å‡ºç»“æœï¼š
âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡ï¼šæœªå‘ç°è¯­æ³•é”™è¯¯

ç»“æ„æ¦‚è§ˆ:
â€¢ æ€»è¡Œæ•°: 2
â€¢ å‡½æ•°æ•°é‡: 1
â€¢ ç±»æ•°é‡: 0
â€¢ å¼•å…¥æ¨¡å—: ï¼ˆæ— ï¼‰

é£æ ¼å»ºè®®ï¼ˆèŠ‚é€‰ï¼‰:
â€¢ ç¬¬1è¡Œç¼ºå°‘å†’å·
â€¢ å»ºè®®æ·»åŠ å‡½æ•°æ–‡æ¡£å­—ç¬¦ä¸²
```

**ä»£ç æ‰§è¡Œç¤ºä¾‹ï¼š**
```python
# è¾“å…¥ç¤ºä¾‹ï¼š
numbers = [1, 2, 3, 4, 5]
squares = [x**2 for x in numbers]
print(f"å¹³æ–¹æ•°: {squares}")

# è¾“å‡ºç»“æœï¼š
âœ… æ‰§è¡ŒæˆåŠŸ:
å¹³æ–¹æ•°: [1, 4, 9, 16, 25]
```

### è¯­éŸ³è¾“å…¥
1. ç‚¹å‡»éº¦å…‹é£æŒ‰é’®å¼€å§‹å½•éŸ³
2. è¯´è¯å†…å®¹å®æ—¶è½¬æ–‡å­—
3. ç‚¹å‡»åœæ­¢ç»“æŸå½•éŸ³
4. è¯†åˆ«ç»“æœè‡ªåŠ¨å¡«å…¥è¾“å…¥æ¡†

### ç½‘é¡µçˆ¬è™«
1. åˆ‡æ¢åˆ°"Pythonçˆ¬è™«"æ ‡ç­¾
2. è¾“å…¥ç›®æ ‡ç½‘å€ï¼ˆå¦‚: https://example.comï¼‰
3. ç‚¹å‡»"å¼€å§‹çˆ¬å–"
4. æŸ¥çœ‹ Markdown æ ¼å¼ç»“æœ
5. å¤åˆ¶å†…å®¹æˆ–å‘é€åˆ°å¯¹è¯

### å¿«æ·é”®
- **Ctrl + Enter**: å‘é€æ¶ˆæ¯
- **Ctrl + N**: æ–°å»ºå¯¹è¯
- **Ctrl + T**: åˆ‡æ¢ä¸»é¢˜
- **Ctrl + M**: è¯­éŸ³è¾“å…¥
- **Ctrl + /**: å¸®åŠ©æç¤º

### ç§»åŠ¨ç«¯ä½¿ç”¨
- åº•éƒ¨å¯¼èˆª: å¯¹è¯ã€å·¥å…·ã€çˆ¬è™«å¿«é€Ÿåˆ‡æ¢
- æ‰‹åŠ¿æ“ä½œ: å·¦æ»‘æ˜¾ç¤ºä¾§è¾¹æ 
- è¯­éŸ³ä¼˜åŒ–: ç§»åŠ¨ç«¯ä¸“ç”¨è¯­éŸ³æŒ‰é’®
- è§¦æ‘¸å‹å¥½: åŠ å¤§ç‚¹å‡»åŒºåŸŸ

## APIæ¥å£

### è®¤è¯ç›¸å…³

**ç”¨æˆ·æ³¨å†Œ**
```http
POST /register
Content-Type: application/json

{
  "username": "newuser",
  "password": "password123"
}

å“åº”:
{
  "success": true,
  "user_id": 1,
  "username": "newuser"
}
```

**ç”¨æˆ·ç™»å½•**
```http
POST /login
Content-Type: application/json

{
  "username": "user",
  "password": "password"
}

å“åº”:
{
  "success": true,
  "user_id": 1,
  "username": "user"
}
```

### å¯¹è¯ç›¸å…³

**å‘é€é—®é¢˜**
```http
POST /ask
Content-Type: application/json
Headers: {Cookie: session}

{
  "question": "Pythonè£…é¥°å™¨æ˜¯ä»€ä¹ˆï¼Ÿ"
}

å“åº”:
{
  "success": true,
  "answer": "è£…é¥°å™¨æ˜¯Pythonä¸­...",
  "timestamp": "14:30:25"
}
```

**è·å–å¯¹è¯å†å²**
```http
GET /get_conversations
Headers: {Cookie: session}

å“åº”:
{
  "success": true,
  "conversations": [
    {
      "id": 1,
      "title": "Pythonè£…é¥°å™¨é—®é¢˜",
      "message_count": 5,
      "updated_at": "2024-01-15 14:30:25"
    }
  ]
}
```

### å·¥å…·ç›¸å…³

**ä»£ç æ‰§è¡Œ**
```http
POST /execute_code
Content-Type: application/json

{
  "code": "print('Hello, World!')"
}

å“åº”:
{
  "success": true,
  "result": "Hello, World!"
}
```

**è¯­æ³•æ£€æŸ¥**
```http
POST /syntax_check
Content-Type: application/json

{
  "code": "def hello()\n    print('hello')"
}

å“åº”:
{
  "success": true,
  "result": "âŒ è¯­æ³•é”™è¯¯: ç¬¬1è¡Œç¼ºå°‘å†’å·"
}
```

**è¯­éŸ³è¯†åˆ«**
```http
POST /voice_recognition
Content-Type: multipart/form-data

FormData:
  audio: [éŸ³é¢‘æ–‡ä»¶]

å“åº”:
{
  "success": true,
  "text": "è¯†åˆ«åˆ°çš„è¯­éŸ³å†…å®¹"
}
```

### é”™è¯¯ç è¯´æ˜
| çŠ¶æ€ç  | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|----------|
| 200 | æˆåŠŸ | æ­£å¸¸å¤„ç† |
| 400 | è¯·æ±‚é”™è¯¯ | æ£€æŸ¥å‚æ•°æ ¼å¼ |
| 401 | æœªæˆæƒ | é‡æ–°ç™»å½• |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æŸ¥çœ‹æœåŠ¡æ—¥å¿— |

## æ•°æ®åº“è®¾è®¡

### æ•°æ®è¡¨ç»“æ„

**users ç”¨æˆ·è¡¨**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INT | ä¸»é”® | AUTO_INCREMENT |
| username | VARCHAR(50) | ç”¨æˆ·å | UNIQUE, NOT NULL |
| password | VARCHAR(255) | å¯†ç å“ˆå¸Œ | NOT NULL |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ | DEFAULT CURRENT_TIMESTAMP |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ | ON UPDATE CURRENT_TIMESTAMP |

**conversations å¯¹è¯è¡¨**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INT | ä¸»é”® | AUTO_INCREMENT |
| user_id | INT | ç”¨æˆ·ID | FOREIGN KEY |
| title | VARCHAR(255) | å¯¹è¯æ ‡é¢˜ | DEFAULT 'æ–°å¯¹è¯' |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ | DEFAULT CURRENT_TIMESTAMP |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ | ON UPDATE CURRENT_TIMESTAMP |

**messages æ¶ˆæ¯è¡¨**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INT | ä¸»é”® | AUTO_INCREMENT |
| conversation_id | INT | å¯¹è¯ID | FOREIGN KEY |
| role | ENUM | æ¶ˆæ¯è§’è‰² | ('user','assistant','system') |
| content | TEXT | æ¶ˆæ¯å†…å®¹ | NOT NULL |
| message_type | VARCHAR(20) | æ¶ˆæ¯ç±»å‹ | DEFAULT 'text' |
| timestamp | TIMESTAMP | æ—¶é—´æˆ³ | DEFAULT CURRENT_TIMESTAMP |

### ç´¢å¼•è®¾è®¡
```sql
-- ç”¨æˆ·è¡¨ç´¢å¼•
CREATE INDEX idx_username ON users(username);

-- å¯¹è¯è¡¨ç´¢å¼•  
CREATE INDEX idx_user_id ON conversations(user_id);
CREATE INDEX idx_updated_at ON conversations(updated_at);

-- æ¶ˆæ¯è¡¨ç´¢å¼•
CREATE INDEX idx_conversation_id ON messages(conversation_id);
CREATE INDEX idx_timestamp ON messages(timestamp);
```

### å…³ç³»å›¾
```
users
  â”‚
  â”œâ”€â”€ conversations (1:N)
  â”‚     â”‚
  â”‚     â””â”€â”€ messages (1:N)
  â”‚
  â””â”€â”€ sessions (1:1)
```

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
PyAssistant/
â”œâ”€â”€ app.py                 # Flaskåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ python_agent.py        # AIæ™ºèƒ½ä»£ç†
â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .env.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html        # ä¸»é¡µé¢æ¨¡æ¿
â””â”€â”€ static/
    â”œâ”€â”€ style.css         # æ ·å¼æ–‡ä»¶
    â”œâ”€â”€ script.js         # å‰ç«¯é€»è¾‘
    â”œâ”€â”€ pyassistant.png   # åº”ç”¨å›¾æ ‡
    â””â”€â”€ temp/             # ä¸´æ—¶æ–‡ä»¶ç›®å½•
```

### ä»£ç è§„èŒƒ

**Python ä»£ç è§„èŒƒ**
```python
def function_name(parameter: type) -> return_type:
    """å‡½æ•°æ–‡æ¡£å­—ç¬¦ä¸²
    
    Args:
        parameter: å‚æ•°è¯´æ˜
        
    Returns:
        è¿”å›å€¼è¯´æ˜
        
    Raises:
        ExceptionType: å¼‚å¸¸è¯´æ˜
    """
    # ä»£ç é€»è¾‘
    pass
```

**JavaScript ä»£ç è§„èŒƒ**
```javascript
/**
 * å‡½æ•°æè¿°
 * @param {string} parameter - å‚æ•°è¯´æ˜
 * @returns {string} è¿”å›å€¼è¯´æ˜
 */
function functionName(parameter) {
    // ä»£ç é€»è¾‘
    return result;
}
```

### æ·»åŠ æ–°åŠŸèƒ½

**1. æ·»åŠ æ–°çš„å·¥å…·**
```python
# åœ¨ python_agent.py ä¸­æ·»åŠ 
def new_tool(self, input_data: str) -> str:
    """æ–°å·¥å…·çš„åŠŸèƒ½æè¿°"""
    try:
        # å·¥å…·é€»è¾‘
        result = process_input(input_data)
        return result
    except Exception as e:
        return f"å·¥å…·æ‰§è¡Œé”™è¯¯: {str(e)}"

# æ³¨å†Œåˆ°å·¥å…·é›†
self.tools["new_tool"] = self.new_tool
```

**2. æ·»åŠ å‰ç«¯é¡µé¢**
```html
<!-- åœ¨ index.html ä¸­æ·»åŠ  -->
<div class="new-container" id="newTab" style="display: none;">
    <div class="new-header">
        <h2>æ–°åŠŸèƒ½é¡µé¢</h2>
    </div>
    <!-- é¡µé¢å†…å®¹ -->
</div>
```

```javascript
// åœ¨ script.js ä¸­æ·»åŠ äº‹ä»¶å¤„ç†
const newToolBtn = document.getElementById('newToolBtn');
newToolBtn.addEventListener('click', function() {
    // åŠŸèƒ½é€»è¾‘
});
```

**3. æ·»åŠ åç«¯è·¯ç”±**
```python
@app.route('/new_tool', methods=['POST'])
@require_login
def new_tool():
    """æ–°å·¥å…·çš„è·¯ç”±å¤„ç†"""
    try:
        data = request.get_json()
        # å¤„ç†é€»è¾‘
        return jsonify({'success': True, 'result': result})
    except Exception as e:
        return jsonify({'error': str(e)}), 500
```

### æµ‹è¯•æŒ‡å—

**å•å…ƒæµ‹è¯•**
```python
import unittest
from app import app, get_db_connection

class TestPyAssistant(unittest.TestCase):
    
    def setUp(self):
        self.app = app.test_client()
        self.app.testing = True
    
    def test_syntax_check(self):
        response = self.app.post('/syntax_check', 
                               json={'code': 'print("hello")'})
        self.assertEqual(response.status_code, 200)
        self.assertIn('success', response.get_json())
```

**é›†æˆæµ‹è¯•**
```bash
# å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨
python app.py

# æµ‹è¯•å„é¡¹åŠŸèƒ½
curl -X POST http://localhost:5007/syntax_check \
  -H "Content-Type: application/json" \
  -d '{"code": "print(\"test\")"}'
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. åº”ç”¨å¯åŠ¨å¤±è´¥**
```
é—®é¢˜: Address already in use
è§£å†³æ–¹æ¡ˆ:
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :5007
# ç»ˆæ­¢è¿›ç¨‹
kill -9 <PID>
# æˆ–æ›´æ¢ç«¯å£
python app.py --port 5008
```

**2. æ•°æ®åº“è¿æ¥é”™è¯¯**
```
é—®é¢˜: pymysql.err.OperationalError
è§£å†³æ–¹æ¡ˆ:
# æ£€æŸ¥MySQLæœåŠ¡
sudo systemctl status mysql
# å¯åŠ¨æœåŠ¡
sudo systemctl start mysql
# æ£€æŸ¥ç”¨æˆ·æƒé™
mysql -u root -p -e "SHOW GRANTS FOR 'pyassistant'@'localhost';"
```

**3. è¯­éŸ³è¯†åˆ«å¤±è´¥**
```
é—®é¢˜: éŸ³é¢‘è½¬æ¢é”™è¯¯
è§£å†³æ–¹æ¡ˆ:
# å®‰è£… FFmpeg
# Ubuntu/Debian
sudo apt update && sudo apt install ffmpeg
# macOS
brew install ffmpeg
# æˆ–å®‰è£… pydubï¼ˆæ¨èï¼‰
pip install pydub
```

**4. AI æœåŠ¡ä¸å¯ç”¨**
```
é—®é¢˜: API å¯†é’¥é”™è¯¯
è§£å†³æ–¹æ¡ˆ:
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $DEEPSEEK_API_KEY
# é‡æ–°é…ç½® .env æ–‡ä»¶
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶å¡«å…¥æ­£ç¡®çš„ API å¯†é’¥
```

**5. å†…å­˜ä¸è¶³**
```python
# è§£å†³æ–¹æ¡ˆï¼šå¢åŠ å†…å­˜é™åˆ¶
@app.route('/process_file', methods=['POST'])
def process_file():
    # è®¾ç½®æ–‡ä»¶å¤§å°é™åˆ¶ (50MB)
    if request.content_length > 50 * 1024 * 1024:
        return jsonify({'error': 'æ–‡ä»¶è¿‡å¤§'}), 400
```

### æ—¥å¿—åˆ†æ

**æŸ¥çœ‹åº”ç”¨æ—¥å¿—**
```python
# åœ¨ app.py ä¸­é…ç½®æ—¥å¿—
import logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('pyassistant.log'),
        logging.StreamHandler()
    ]
)
```

**å¸¸è§é”™è¯¯æ—¥å¿—**
```plaintext
# æ•°æ®åº“è¿æ¥é”™è¯¯
ERROR: pymysql.err.OperationalError: (1045, "Access denied for user...")

# API å¯†é’¥é”™è¯¯
ERROR: openai.AuthenticationError: Incorrect API key provided

# å†…å­˜ä¸è¶³
ERROR: MemoryError: Unable to allocate 256. MiB for an array...
```

### æ€§èƒ½ä¼˜åŒ–

**æ•°æ®åº“ä¼˜åŒ–**
```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_messages_timestamp ON messages(timestamp);
CREATE INDEX idx_conversations_user_updated ON conversations(user_id, updated_at);

-- å®šæœŸæ¸…ç†
DELETE FROM messages WHERE timestamp < DATE_SUB(NOW(), INTERVAL 30 DAY);
```

**ç¼“å­˜ä¼˜åŒ–**
```python
from functools import lru_cache

@lru_cache(maxsize=100)
def get_cached_documentation(topic: str) -> str:
    """ç¼“å­˜æ–‡æ¡£æŸ¥è¯¢ç»“æœ"""
    return self.python_documentation(topic)
```

## æŠ€æœ¯æ”¯æŒ

- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
- æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
- é‡æ–°åˆå§‹åŒ–AI
- GitHub Issues
- æ–‡æ¡£æ›´æ–°
- ç‰ˆæœ¬æ›´æ–°

**ç‰ˆæœ¬ä¿¡æ¯:**
- PyAssistant: v1.0.0
- Flaskç‰ˆæœ¬: 2.3.3
- Pythonç‰ˆæœ¬: 3.8+
- æœ€åæ›´æ–°: 2025å¹´12æœˆ
